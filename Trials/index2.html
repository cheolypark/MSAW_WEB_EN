<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="jointjs/joint.css" />
    <script src="node_modules/graphlib/dist/graphlib.js"></script>
    <script src="node_modules/dagre/dist/dagre.js"></script>
    
    <script src="jointjs/jquery224.js"></script>
    <script src="jointjs/lodash3.js"></script>
    <script src="jointjs/backbone.js"></script>
    <script src="jointjs/joint.js"></script>
</head>
<body>
  <div id="myholder"></div>
  <script type="text/javascript">
  $(document).ready();
    var graph = new joint.dia.Graph;
    
    var paper = new joint.dia.Paper({
        el: $('#myholder'),
        width: 600,
        height: 200,
        model: graph,
        gridSize: 1
    });
    paper.on('cell:pointerclick', function(cellView) {
    	cellView.highlight();
	});

    var rect = new joint.shapes.basic.Rect({
        position: { x: 100, y: 30 },
        size: { width: 100, height: 30 },
        attrs: { rect: { fill: 'blue' }, text: { text: 'my box', fill: 'white' } }
    });

	joint.shapes.basic.Rect =joint.shapes.basic.Generic.extend({
	    markup: '<g class="rotatable"><g class="scalable"><rect/></g><text/></g>',

	    defaults: joint.util.deepSupplement({
	        type: 'basic.Rect',
	        attrs: {
	            'rect': { 'fill': 'red', 'stroke': 'black', 'follow-scale': true, width: 80, height: 40 },
	            'text': { 'font-size': 14, 'ref-x': .5, 'ref-y': .5, ref: 'rect', 'y-alignment': 'middle', 'x-alignment': 'middle', 'text': 'yo' }
	        }
	    }, joint.shapes.basic.Generic.prototype.defaults)
	});
	var rect2 = new joint.shapes.basic.Rect({
        position: { x: 100, y: 30 },
        size: { width: 100, height: 30 }
    });
    rect2.translate(300);
	
    var link = new joint.dia.Link({
        source: { id: rect.id },
        target: { id: rect2.id }
    });

    graph.addCells([rect, rect2, link]);
    

	paper.on('cell:pointerdown', function(cellView, evt, x, y) { 
    	if(cellView.model.id == rect.id)
 			alert('cell view ' + cellView.model.id + ' was clicked');
 		else{
 			rect2.attr({
 				text: {text: 'lala\nggrgret'}
 			});
 			rect2.resize( 100, 60 );
 			var jsongraph= graph.toJSON();
 			alert('json' + JSON.stringify(jsongraph));
 		}
	});
  </script>
</body>
</html>